ccs_define("microsoft365",["jquery","ElementQueries","babelHelpers"],function(r,o,a){"use strict";var c="[data-action-context]",n="ccs-logo-ms365-active",s=".ccs-logo-ms365-wrapper",i=".ccs-logo-ms365-inner",p=".ccs-logo-ms365-main-tab",l=".ccs-logo-ms365-sub-tab",d=".ccs-logo-ms365-tabcontent",u=".ccs-logo-ms365-cards",m=".ccs-logo-ms365-specs",t="ccs-logo-ms365-footer-text",e="[data-logo-addtocart]",v="[data-logo-dynamic-price]",f="ccs-ms365-promo-fake-atc",C="data-promo",y="ccs-ms365-promo",k="data-show-popup",h={banner:"ccs-ms365-promo-banner",top:"ccs-ms365-promo-banner-top",bottom:"ccs-ms365-promo-banner-bottom"},g={popup:"ccs-ms365-promo-popup",show:"ccs-ms365-popup-show",modalWindow:"ccs-ms365-promo-modal",closeBtn:"ccs-ms365-promo-close",content:"ccs-ms365-promo-content",picture:"ccs-ms365-promo-picture",title:"ccs-ms365-promo-title",description:"ccs-ms365-promo-desc",copyCodeBtn:"ccs-ms365-promo-copy-code-btn",couponCode:"ccs-ms365-promo-coupon-code"},b=function(){function e(o,t){a.classCallCheck(this,e),this.o=o,this.$ep=t,this.create()}return a.createClass(e,[{key:"create",value:function(){var t=this;t.$ep.on("click",c,function(o){return t.logEvent(o.target)}),t.$ep.on("click",p,function(o){return t.mainTabClick(o.target)}),t.$ep.on("click",l,function(o){return t.contentTabClick(o.target)}),t.$ep.on("keypress",p,function(o){32!==o.keyCode&&13!==o.keyCode||t.mainTabClick(o.target)}),t.$ep.on("keypress",l,function(o){32!==o.keyCode&&13!==o.keyCode||t.contentTabClick(o.target)})}},{key:"logEvent",value:function(o){var t={ActionContext:r(o).data("action-context")};ccs_cc_log.dispatchEvent(this.o.logEvent,t)}},{key:"mainTabClick",value:function(o){var t=r(o);t.hasClass(n)||(t.parent().find(".".concat(n)).toggleClass(n).attr("aria-selected",!1),t.toggleClass(n).attr("aria-selected",!0).closest(s).find(d).toggleClass(n))}},{key:"contentTabClick",value:function(o){var t=r(o);t.hasClass(n)||(t.parent().find("".concat(l)).attr("aria-selected",!1),t.attr("aria-selected",!0),t.closest(d).find("".concat(l,", ").concat(u,", ").concat(m)).toggleClass(n))}}]),e}(),T=function(o){function n(o,t){var e;a.classCallCheck(this,n),(e=a.possibleConstructorReturn(this,a.getPrototypeOf(n).apply(this,arguments))).promo=o.promo,e.$contents=t.find(i),e.$footer=e.renderFooter(),e.$container=r(".".concat(y)).attr(k,o.promo.showPopup).prependTo(e.$footer);var c=t.find(v);return e.applyDiscount(c),e.renderPromoElements(),e.initPromoEvents(),e.$ep.attr(C,!0),e}return a.inherits(n,o),a.createClass(n,[{key:"renderFooter",value:function(){var o='<div class="ccs-logo-ms365-footer">\n\t<div class="'.concat(y,'"></div>\n\t<div class="').concat(t,'">').concat(this.promo.footerText,"</div>\n</div>");return r(o).appendTo(this.$contents)}},{key:"applyDiscount",value:function(o){var a=this;r.each(o,function(o,t){var e=r(t),c=e.text().trim();if(0!==c.length){var n=a.getDiscountPrice(c,a.promo.discountValue);n&&e.empty().append('<div class="ccs-ms365-current-price">'.concat(c,"</div>")).append('<div class="ccs-ms365-promo-price">'.concat(n,"</div>"))}})}},{key:"getDiscountPrice",value:function(o,t){var e,c=(o=o.replace(",",".")).match(/\d+\.\d+|\d+/);return c?t?((e=t.relative?c*(1-t.relative):c-t.absolute)%1!=0&&(e=e.toFixed(2)),!(e<=0)&&o.replace(c,e)):o:""}},{key:"renderPromoElements",value:function(){var o=this;(o.renderBanner(h,o.promo.bannerTexts).appendTo(o.$container),o.promo.showPopup)&&(o.renderPopup(g,o.promo.popupTexts).appendTo(o.$contents.parent()),o.renderFakeATC())}},{key:"renderBanner",value:function(o,t){var e='<div class="'.concat(o.banner,'" tabindex="0" role="button">\n\t<div class="').concat(o.top,'">').concat(t.top,'</div>\n\t<div class="').concat(o.bottom,'">').concat(t.bottom,"</div>\n</div>");return r(e)}},{key:"renderPopup",value:function(o,t){var e='<div class="'.concat(o.popup,'">\n\t<div class="').concat(o.modalWindow,'">\n\t\t<div class="').concat(o.closeBtn,'" tabindex="0" role="button"></div>\n\t\t<div class="').concat(o.content,'">\n\t\t\t<div class="').concat(o.title,'">').concat(t.title,'</div>\n\t\t\t<input aria-label="').concat(t.couponCode,'" class="').concat(o.couponCode,'" value="').concat(t.couponCode,'" type="text" readonly contenteditable="false">\n\t\t\t<div class="').concat(o.description,'">').concat(t.description,'</div>\n\t\t\t<a class="').concat(o.copyCodeBtn,'" href="#" role="button">').concat(t.copyCodeBtn,'</a>\n\t\t</div>\n\t\t<div class="').concat(o.picture,'"></div>\n\t</div>\n</div>');return r(e)}},{key:"renderFakeATC",value:function(){var o=this.$ep.find(e);if(0!==o.length){var t=r("<div>").addClass(f);o.before(t)}}},{key:"initPromoEvents",value:function(){var t=this;t.$ep.on("click",".".concat(g.copyCodeBtn),function(){return t.logEventPromo()}),t.$ep.on("keypress",".".concat(g.copyCodeBtn),function(o){13===o.keyCode&&t.logEventPromo()}),t.$ep.on("click","[".concat(k,"]"),function(){return t.showPopup()}),t.$ep.on("keypress","[".concat(k,"]"),function(o){13===o.keyCode&&t.showPopup()}),t.$ep.on("click",".".concat(g.closeBtn),function(o){return t.closePopup(r(o.target))}),t.$ep.on("keypress",".".concat(g.closeBtn),function(o){13===o.keyCode&&t.closePopup(r(o.target))}),t.$ep.on("click",".".concat(f),function(o){t.showPopup(),t.showPopupOnAddToCartClick(r(o.target))}),t.$ep.on("keypress",".".concat(f),function(o){13===o.keyCode&&(t.showPopup(),t.showPopupOnAddToCartClick(r(o.target)))}),t.$ep.on("click",".".concat(g.copyCodeBtn),function(o){t.copyCodeToClipboard(),t.closePopup(r(o.target))}),t.$ep.on("keypress",".".concat(g.copyCodeBtn),function(o){13===o.keyCode&&(t.copyCodeToClipboard(),t.closePopup(r(o.target)))}),t.$ep.on("ccsPrice.success",v,function(o){return t.applyDiscount(r(o.target))})}},{key:"logEventPromo",value:function(){ccs_cc_log.dispatchEvent(this.o.logEvent,{Action:"click",ActionContext:"copy-to-clipboard"})}},{key:"showPopup",value:function(){this.$ep.find(".".concat(g.popup)).addClass(g.show)}},{key:"showPopupOnAddToCartClick",value:function(o){var t=this,e=r(o);t.$ep.find(".".concat(g.closeBtn)).off("click.ccs_Microsoft365Promo").one("click.ccs_Microsoft365Promo",function(o){t.triggerClickToATC(e),t.closePopup(r(o.target))}),t.$ep.find(".".concat(g.copyCodeBtn)).off("click.ccs_Microsoft365Promo").one("click.ccs_Microsoft365Promo",function(o){o.stopPropagation(),t.copyCodeToClipboard(),t.triggerClickToATC(e),t.closePopup(r(o.target))})}},{key:"closePopup",value:function(o){o.closest(".".concat(g.popup)).removeClass(g.show)}},{key:"triggerClickToATC",value:function(o){var t=o.next(),e=t.find("input[type=submit]").length?"input[type=submit]":"a, button",c=t.find(e)[0];c&&c.click()}},{key:"copyCodeToClipboard",value:function(){var o=this.$ep.find(".".concat(g.couponCode));o.focus().select(),document.execCommand("copy")||this.iosCopyFallback(o),o.blur()}},{key:"iosCopyFallback",value:function(o){var t=o[0],e=t.contentEditable,c=t.readOnly;t.contentEditable=!0,t.readOnly=!0;var n=document.createRange();n.selectNodeContents(t);var a=window.getSelection();a.removeAllRanges(),a.addRange(n),t.setSelectionRange(0,999999),t.contentEditable=e,t.readOnly=c,document.execCommand("copy")}}]),n}(b),$=function(o){function c(o,t){var e;return a.classCallCheck(this,c),(e=a.possibleConstructorReturn(this,a.getPrototypeOf(c).apply(this,arguments))).promo=o.promo,e.$contents=t.find(i),e.$header=e.$contents.find(".ccs-logo-ms365-header"),e.$footer=e.renderFooter(),e.renderHeader(),e.renderCardText(),e._mainTabClick=e.mainTabClick,e.mainTabClick=e.mainTabClickOverride,e}return a.inherits(c,o),a.createClass(c,[{key:"renderFooter",value:function(){var o='<div class="ccs-logo-ms365-footer">\n\t\t\t\t<div class="ccs-logo-ms365-footer-extratime">'.concat(this.promo.footerText,"</div>\n\t\t\t</div>");return r(o).appendTo(this.$contents)}},{key:"renderHeader",value:function(){var o='<div class="ccs-logo-ms365-header-logo"></div>\n\t\t\t<div class="ccs-logo-ms365-office-is-microsoft-now">'.concat(this.promo.headerText,"</div>");this.$header.find(".ccs-logo-ms365-header-logo").replaceWith(r(o))}},{key:"renderCardText",value:function(){var n=this;this.$contents.find(".ccs-logo-ms365-card").each(function(o,t){var e=r(t);if(e.attr("data-promo-type")===n.promo.type&&e.attr("data-product-type")===n.promo.productType)if(e.attr("data-family")===n.promo.productFamily){var c='<div class="ccs-logo-ms365-extratime-card">\n\t\t\t\t\t\t'.concat(n.promo.cardText,"\n\t\t\t\t\t</div>");r(c).appendTo(e)}else e.addClass("ccs-logo-ms365-card__without-promo")})}},{key:"mainTabClickOverride",value:function(o){this._mainTabClick(o),r(o).attr("data-action-context")===this.promo.productType?this.$footer.show():this.$footer.hide()}}]),c}(b);return function(o){var t=r("#".concat(o.entryPointId));if(0!==t.length){var e=o.promo?"TwentyDollarsPromo"===o.promo.type?new T(o,t):"ExtraTimeOffer"===o.promo.type?new $(o,t):new b(o,t):new b(o,t);t.data("microsoft365",e)}}});
//# sourceMappingURL=microsoft365.min.js.map
